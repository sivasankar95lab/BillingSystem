<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="A professional, free, and easy-to-use Indian Invoice Generator. Compliant with GST standards, supporting Tax Invoices, Simple Invoices, Delivery Challans, and Quotations.">
    <meta name="keywords"
        content="Invoice Generator, GST Invoice, Indian Taxation, Tax Invoice, Delivery Challan, Quotation, PDF Invoice, Free Billing Software">
    <meta name="author" content="InvoiceGenerator">
    <meta name="theme-color" content="#2563eb">

    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://invoice-generator.pages.dev/">
    <meta property="og:title" content="Invoice Generator - Free GST Compliant Billing">
    <meta property="og:description"
        content="Generate professional GST-compliant invoices, challans, and quotes in seconds. Secure, fast, and completely free.">
    <meta property="og:image" content="https://i.ibb.co/5XvB03Hm/logosmallsize.png">

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="https://invoice-generator.pages.dev/">
    <meta property="twitter:title" content="Invoice Generator - Free GST Compliant Billing">
    <meta property="twitter:description"
        content="Generate professional GST-compliant invoices, challans, and quotes in seconds. Secure, fast, and completely free.">
    <meta property="twitter:image" content="https://i.ibb.co/5XvB03Hm/logosmallsize.png">

    <title>Invoice Generator</title>

    <!-- Manifest & PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="https://i.ibb.co/5XvB03Hm/logosmallsize.png">

    <!-- Favicon: Rupee Symbol -->
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22 fill=%22%232563eb%22>₹</text></svg>">

    <!-- Google Fonts: Outfit -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="bg-light text-dark">

    <nav class="navbar navbar-expand-lg navbar-light bg-white shadow-sm border-bottom">
        <div class="container-fluid">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <i class="fas fa-file-invoice text-primary me-2 fs-4"></i>
                <span class="fw-bold tracking-tight text-dark h4 mb-0">Invoice<span
                        class="text-primary">Generator</span></span>
            </a>

            <div class="d-flex align-items-center gap-3">
                <!-- Connection Status -->
                <div id="connectionIndicator" class="text-secondary" title="Connection Status">
                    <i class="fas fa-wifi" id="connectionIcon"></i>
                </div>

                <!-- Sync Activity -->
                <div id="syncActivity" class="text-secondary" title="Sync Status">
                    <i class="fas fa-sync" id="syncIcon"></i>
                </div>

                <!-- Status Text -->
                <div id="syncStatusText" class="badge bg-light text-secondary border fw-normal" style="cursor: pointer;"
                    onclick="SyncManager.showHelp()">
                    <span id="syncText">Connecting...</span>
                </div>

                <!-- Database Management Dropdown -->
                <div class="dropdown">
                    <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" id="dbMenuBtn"
                        data-bs-toggle="dropdown" aria-expanded="false" title="Database Management">
                        <i class="fas fa-database me-1"></i>Data
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dbMenuBtn">
                        <li><a class="dropdown-item" href="#" onclick="DataManager.viewDatabase(); return false;">
                                <i class="fas fa-eye me-2"></i>View Local Database
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item" href="#" onclick="DataManager.exportData(); return false;">
                                <i class="fas fa-download me-2"></i>Export All Data
                            </a></li>
                        <li><a class="dropdown-item" href="#" onclick="DataManager.importData(); return false;">
                                <i class="fas fa-upload me-2"></i>Import Data
                            </a></li>
                        <li>
                            <hr class="dropdown-divider">
                        </li>
                        <li><a class="dropdown-item text-danger" href="#" onclick="ErrorLogger.open(); return false;">
                                <i class="fas fa-exclamation-circle me-2"></i>View Error Logs
                            </a></li>
                    </ul>
                </div>
            </div>
        </div>
    </nav>

    <!-- Setup Help Modal -->
    <div class="modal fade" id="setupHelpModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-database me-2"></i>Setup Cloud Backup</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="modal-scroll-area">
                        <p>To enable cloud backup, you need to create a table in your Supabase project.</p>
                        <ol>
                            <li>Go to your <a href="https://supabase.com/dashboard" target="_blank">Supabase
                                    Dashboard</a>.
                            </li>
                            <li>Open the <strong>SQL Editor</strong>.</li>
                            <li>Copy and run the following command:</li>
                        </ol>
                        <div class="bg-light p-3 rounded border mb-3 position-relative">
                            <pre class="mb-0 small"><code>create table if not exists user_data (
  key text primary key,
  value jsonb,
  updated_at timestamp with time zone default timezone('utc'::text, now())
);
alter table user_data enable row level security;
create policy "Allow generic access" on user_data for all using (true) with check (true);</code></pre>
                            <button class="btn btn-sm btn-outline-primary position-absolute top-0 end-0 m-2"
                                onclick="navigator.clipboard.writeText(this.previousElementSibling.textContent); this.textContent = 'Copied!'; setTimeout(()=>this.textContent='Copy', 2000);">Copy</button>
                        </div>
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i> Once created, refresh this page to connect.
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- View Database Modal -->
    <div class="modal fade" id="viewDatabaseModal" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title"><i class="fas fa-database me-2"></i>Local Database Contents</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="modal-scroll-area">
                        <div class="alert alert-info">
                            <i class="fas fa-info-circle me-2"></i>
                            This shows all data stored in your browser's local storage. You can export this data as a
                            backup.
                        </div>
                        <div id="databaseContent" class="p-3 rounded border bg-light">
                            <pre class="mb-0"><code id="databaseJson">Loading...</code></pre>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="DataManager.exportData()">
                        <i class="fas fa-download me-1"></i>Export This Data
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <div class="container py-4">
        <form id="invoiceForm">
            <div class="row g-4">
                <!-- Main Invoice Area -->
                <div class="col-lg-8">
                    <!-- Invoice Details Card -->
                    <div class="card shadow-sm border-0 mb-4">
                        <div
                            class="card-header bg-white border-bottom py-3 d-flex justify-content-between align-items-center">
                            <h5 class="mb-0 text-primary"><i class="fas fa-info-circle me-2"></i>Invoice Details</h5>
                            <div class="col-md-6 text-md-end no-print">
                                <button type="button" class="btn btn-outline-success me-2"
                                    onclick="InvoiceManager.saveCurrent()">
                                    <i class="fas fa-save me-1"></i>Save
                                </button>
                                <button type="button" class="btn btn-outline-secondary me-2"
                                    onclick="InvoiceManager.openHistory()">
                                    <i class="fas fa-history me-1"></i>History
                                </button>
                                <button type="button" class="btn btn-danger" id="resetBtn">
                                    <i class="fas fa-redo me-1"></i>Reset
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label fw-medium">Invoice Number</label>
                                    <input type="text" class="form-control" id="invoiceNumber" placeholder="INV-001"
                                        value="INV-001" required>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-medium">Date</label>
                                    <input type="date" class="form-control" id="invoiceDate" required>
                                </div>
                            </div>

                            <hr class="my-4">

                            <div class="row g-4">
                                <!-- Company Details -->
                                <div class="col-md-6 border-end-md">
                                    <h6 class="mb-3 text-secondary d-flex justify-content-between align-items-center">
                                        <span>My Company (From)</span>
                                        <button type="button" class="btn btn-sm btn-outline-secondary"
                                            onclick="openProfileModal('company')">
                                            <i class="fas fa-folder-open me-1"></i> Manage
                                        </button>
                                    </h6>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Business Name</label>
                                        <input type="text" class="form-control" id="companyName"
                                            placeholder="Your Company Name">
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">GSTIN</label>
                                        <input type="text" class="form-control" id="companyGst"
                                            placeholder="e.g. 29AAAAA0000A1Z5">
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Phone Number</label>
                                        <input type="text" class="form-control" id="companyPhone"
                                            placeholder="Ex: +91 9876543210">
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Email</label>
                                        <input type="email" class="form-control" id="companyEmail"
                                            placeholder="company@example.com">
                                    </div>

                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Address</label>
                                        <textarea class="form-control" id="companyAddress" rows="2"
                                            placeholder="Full Address">No.1, Old Mahabalipuram Road, Kandanchavadi, Chennai 600096.</textarea>
                                    </div>

                                    <hr class="my-3">

                                    <!-- Logo Section (Moved) -->
                                    <h6 class="mb-3 text-secondary">Company Logo <span
                                            class="text-muted small fw-normal">(Rec: 550x550px PNG)</span></h6>
                                    <div class="mb-3">
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="logoOption"
                                                id="logoUrlOption" value="url" checked>
                                            <label class="form-check-label" for="logoUrlOption">Image URL</label>
                                        </div>
                                    </div>

                                    <div id="logoUrlInput" class="">
                                        <div class="input-group">
                                            <input class="form-control" type="url" id="logoUrl"
                                                placeholder="https://example.com/logo.png">
                                            <button class="btn btn-outline-secondary" type="button"
                                                id="clearLogoUrlBtn">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                        <button type="button" class="btn btn-sm btn-outline-primary mt-2"
                                            id="previewLogoUrlBtn">Load Image</button>
                                    </div>

                                    <div class="mt-3 text-center p-2 bg-light rounded border"
                                        style="min-height: 100px; display: flex; align-items: center; justify-content: center;">
                                        <img id="logoPreview" src="" alt="Logo Preview"
                                            style="max-width: 100%; max-height: 100px; display: none;">
                                        <span class="text-muted small" id="logoPlaceholder">No Logo Selected</span>
                                    </div>

                                    <hr class="my-3">

                                    <!-- Signature Section (Moved) -->
                                    <h6 class="mb-3 text-secondary">Authorized Signature <span
                                            class="text-muted small fw-normal">(Rec: 400x150px PNG)</span></h6>
                                    <div class="mb-3">
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="signatureOption"
                                                id="sigDrawOption" value="draw">
                                            <label class="form-check-label" for="sigDrawOption">Draw</label>
                                        </div>
                                        <div class="form-check form-check-inline">
                                            <input class="form-check-input" type="radio" name="signatureOption"
                                                id="sigUrlOption" value="url" checked>
                                            <label class="form-check-label" for="sigUrlOption">Image URL</label>
                                        </div>
                                    </div>

                                    <div id="sigDrawInput" class="d-none">
                                        <canvas id="signatureCanvas" class="border rounded bg-white w-100"
                                            height="150"></canvas>
                                        <button type="button" class="btn btn-sm btn-outline-danger w-100 mt-1"
                                            id="clearSignatureBtn"><i class="fas fa-eraser me-1"></i>Clear
                                            Signature</button>
                                    </div>

                                    <div id="sigUrlInput" class="">
                                        <div class="input-group">
                                            <input type="text" class="form-control" id="signatureUrl"
                                                placeholder="https://example.com/signature.png">
                                            <button class="btn btn-outline-secondary" type="button" id="clearSigUrlBtn">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                        <div class="mt-3 text-center p-2 bg-light rounded border"
                                            style="min-height: 100px; display: flex; align-items: center; justify-content: center;">
                                            <img id="signatureUrlPreview" src="" alt="Signature Preview"
                                                style="max-width: 100%; max-height: 100px; display: none;">
                                            <span class="text-muted small" id="signatureUrlPlaceholder">Preview will
                                                appear here</span>
                                        </div>
                                    </div>
                                </div>

                                <!-- Client Details -->
                                <div class="col-md-6">
                                    <h6 class="mb-3 text-secondary d-flex justify-content-between align-items-center">
                                        <span>Client Details (To)</span>
                                        <button type="button" class="btn btn-sm btn-outline-secondary"
                                            onclick="openProfileModal('client')">
                                            <i class="fas fa-folder-open me-1"></i> Manage
                                        </button>
                                    </h6>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Client Name</label>
                                        <input type="text" class="form-control" id="clientName"
                                            placeholder="Client Name">
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Client GSTIN</label>
                                        <input type="text" class="form-control" id="clientGst"
                                            placeholder="Client GSTIN (Optional)">
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Phone Number</label>
                                        <input type="text" class="form-control" id="clientPhone"
                                            placeholder="Ex: +91 9876543210">
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Email</label>
                                        <input type="email" class="form-control" id="clientEmail"
                                            placeholder="client@example.com">
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Notes</label>
                                        <input type="text" class="form-control" id="clientNotes"
                                            placeholder="Internal notes (not on PDF)">
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Place of Supply</label>
                                        <select class="form-select" id="clientState">
                                            <option value="Same State">Intra-State (CGST + SGST)</option>
                                            <option value="Inter State">Inter-State (IGST)</option>
                                        </select>
                                    </div>
                                    <div class="mb-2">
                                        <label class="form-label small text-muted">Address</label>
                                        <textarea class="form-control" id="clientAddress" rows="2"
                                            placeholder="Client address"></textarea>
                                    </div>
                                </div>
                            </div>

                            <hr class="my-4">

                            <!-- Transport Details (Optional) -->
                            <h6 class="mb-3 text-secondary">Transport Details <span
                                    class="text-muted small fw-normal">(For Delivery Challan)</span></h6>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label small text-muted">Transport Mode</label>
                                    <select class="form-select form-select-sm" id="transportMode">
                                        <option value="">Select Mode</option>
                                        <option value="Road" selected>Road</option>
                                        <option value="Rail">Rail</option>
                                        <option value="Air">Air</option>
                                        <option value="Ship">Ship</option>
                                    </select>
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label small text-muted">Vehicle/Ref Number</label>
                                    <input type="text" class="form-control form-control-sm" id="vehicleNumber"
                                        placeholder="e.g. KA-01-AB-1234">
                                </div>
                            </div>
                        </div>
                    </div>



                    <!-- Payment Details Card -->
                    <div class="card shadow-sm border-0 mb-4">
                        <div
                            class="card-header bg-white border-bottom py-3 d-flex justify-content-between align-items-center">
                            <h5 class="mb-0 text-primary"><i class="fas fa-university me-2"></i>Payment Details</h5>
                            <button type="button" class="btn btn-sm btn-outline-primary"
                                onclick="openProfileModal('payment')">
                                <i class="fas fa-address-book me-1"></i>Manage
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="row g-3">
                                <div class="col-12">
                                    <label class="form-label small text-muted">Account Name</label>
                                    <input type="text" class="form-control" id="accountName"
                                        placeholder="Account Holder Name">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label small text-muted">Bank Name - Branch</label>
                                    <input type="text" class="form-control" id="bankName"
                                        placeholder="e.g. HDFC Bank - Main Branch">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label small text-muted">Account Number</label>
                                    <input type="text" class="form-control" id="accountNumber" placeholder="0000000000">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label small text-muted">IFSC Code</label>
                                    <input type="text" class="form-control" id="ifscCode" placeholder="HDFC0001234">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label small text-muted">UPI ID</label>
                                    <input type="text" class="form-control" id="upiId" placeholder="username@bank">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Items Card -->
                    <div class="card shadow-sm border-0">
                        <div
                            class="card-header bg-white border-bottom py-3 d-flex justify-content-between align-items-center">
                            <h5 class="mb-0 text-primary"><i class="fas fa-list me-2"></i>Items</h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="table-responsive">
                                <table class="table table-hover align-middle mb-0" id="itemsTable">
                                    <thead class="bg-light text-secondary">
                                        <tr>
                                            <th style="width: 35%;">Item Name</th>
                                            <th style="width: 15%;">HSN/SAC</th>
                                            <th style="width: 10%;">Qty</th>
                                            <th style="width: 15%;">Rate</th>
                                            <th style="width: 15%;">GST</th>
                                            <th style="width: 10%; text-align: right;">Amount</th>
                                            <th style="width: 5%;"></th>
                                        </tr>
                                    </thead>
                                    <tbody id="itemsBody">
                                        <!-- Dynamic Rows -->
                                    </tbody>
                                </table>
                            </div>
                            <div id="emptyState" class="text-center py-5 d-none">
                                <i class="fas fa-box-open fa-3x text-muted mb-3"></i>
                                <p class="text-muted">No items added yet</p>
                            </div>

                            <!-- Buttons Footer -->
                            <div class="p-4 border-top bg-light d-flex justify-content-start gap-3">
                                <button type="button" class="btn btn-primary" id="addItemBtn">
                                    <i class="fas fa-plus me-1"></i>Add Item
                                </button>
                                <button type="button" class="btn btn-outline-primary" onclick="openItemModal()">
                                    <i class="fas fa-list me-1"></i>Manage Items
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Notes Card -->
                    <div class="card shadow-sm border-0 mt-4">
                        <div class="card-header bg-white border-bottom py-3">
                            <h5 class="mb-0 text-primary"><i class="fas fa-sticky-note me-2"></i>Additional Notes</h5>
                        </div>
                        <div class="card-body">
                            <textarea class="form-control" id="invoiceNote" rows="3"
                                placeholder="Terms & Conditions, Payment Instructions, or any other notes..."></textarea>
                            <div class="form-text">These notes will appear at the bottom of the invoice.</div>
                        </div>
                    </div>
                </div>

                <!-- Sidebar Summary -->
                <div class="col-lg-4">
                    <div class="card shadow-sm border-0 mb-4 sticky-top" style="top: 20px; z-index: 100;">
                        <div class="card-body p-4">
                            <h5 class="card-title mb-4 fw-bold">Summary</h5>

                            <!-- Discount Section -->
                            <div class="mb-3">
                                <label class="form-label small text-muted">Discount</label>
                                <div class="input-group input-group-sm mb-2">
                                    <div class="input-group-text bg-white">
                                        <div class="form-check form-check-inline mb-0 me-0">
                                            <input class="form-check-input" type="radio" name="discountType"
                                                id="discFixed" value="fixed" checked>
                                            <label class="form-check-label small" for="discFixed">₹</label>
                                        </div>
                                    </div>
                                    <div class="input-group-text bg-white border-start-0">
                                        <div class="form-check form-check-inline mb-0 me-0">
                                            <input class="form-check-input" type="radio" name="discountType"
                                                id="discPercent" value="percent">
                                            <label class="form-check-label small" for="discPercent">%</label>
                                        </div>
                                    </div>
                                    <input type="number" class="form-control text-end" id="discountValue"
                                        placeholder="0" min="0">
                                </div>
                            </div>

                            <div class="d-flex justify-content-between mb-2">
                                <span class="text-muted">Subtotal</span>
                                <span class="fw-medium" id="summarySubtotal">₹0.00</span>
                            </div>

                            <div class="d-flex justify-content-between mb-2 small text-success" id="discountRow">
                                <span class="text-muted">Discount</span>
                                <span id="summaryDiscount">- ₹0.00</span>
                            </div>

                            <div class="d-flex justify-content-between mb-2 small" id="cgstRow">
                                <span class="text-muted">CGST</span>
                                <span class="text-dark" id="summaryCGST">₹0.00</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2 small" id="sgstRow">
                                <span class="text-muted">SGST</span>
                                <span class="text-dark" id="summarySGST">₹0.00</span>
                            </div>
                            <div class="d-flex justify-content-between mb-2 small d-none" id="igstRow">
                                <span class="text-muted">IGST</span>
                                <span class="text-dark" id="summaryIGST">₹0.00</span>
                            </div>

                            <hr>

                            <div class="d-flex justify-content-between mb-4">
                                <span class="h5 mb-0">Total</span>
                                <span class="h5 mb-0 text-primary" id="summaryTotal">₹0.00</span>
                            </div>

                            <div class="mb-4 small text-muted text-end" id="summaryAmountInWordsRow">
                                <span id="summaryAmountInWords" class="fst-italic text-secondary">Zero Rupees
                                    Only</span>
                            </div>

                            <div class="d-grid gap-2">
                                <button type="button" class="btn btn-primary py-2" id="btnTaxInvoice">
                                    <i class="fas fa-file-invoice me-2"></i>Download Tax Invoice
                                </button>
                                <button type="button" class="btn btn-success py-2" id="btnSimpleInvoice">
                                    <i class="fas fa-file-alt me-2"></i>Simple Invoice (No Tax)
                                </button>
                                <button type="button" class="btn btn-info text-white py-2" id="btnQuote">
                                    <i class="fas fa-file-invoice-dollar me-2"></i>Download Quote
                                </button>
                                <button type="button" class="btn btn-warning py-2" id="btnChallan">
                                    <i class="fas fa-truck me-2"></i>Delivery Challan
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <!-- Floating Logo -->
    <img src="https://i.ibb.co/5XvB03Hm/logosmallsize.png" class="fixed-bottom-logo" alt="Logo">

    <!-- Profile Management Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="profileModalTitle">Manage Profiles</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0">
                    <div
                        class="p-3 bg-light border-bottom d-flex align-items-center justify-content-between flex-wrap gap-2">
                        <div>
                            <button class="btn btn-primary btn-sm" id="addProfileRowBtn">
                                <i class="fas fa-plus me-1"></i> Add New Row
                            </button>
                            <span class="text-muted small ms-2">Click on a cell to edit.</span>
                        </div>
                        <div class="text-muted small">
                            <i class="fas fa-info-circle text-primary me-1"></i>
                            <strong>Logo:</strong> 550x550px | <strong>Signature:</strong> 400x150px (Transparent PNG)
                        </div>
                    </div>
                    <div class="modal-scroll-area">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0 align-middle">
                                <thead>
                                    <tr id="profileTableHeader">
                                        <!-- Dynamic Headers -->
                                    </tr>
                                </thead>
                                <tbody id="profileTableBody">
                                    <!-- Dynamic Rows -->
                                </tbody>
                            </table>
                        </div>
                        <div id="profileEmptyState" class="text-center py-5 text-muted d-none">
                            <i class="fas fa-folder-open fa-3x mb-3 opacity-50"></i>
                            <p>No profiles found. Add a row to get started.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Item DataList -->
    <datalist id="itemList"></datalist>
    <datalist id="gstRates">
        <option value="0">
        <option value="5">
        <option value="12">
        <option value="18">
        <option value="28">
    </datalist>

    <!-- Item Manager Modal -->
    <div class="modal fade" id="itemModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Manage Predefined Items</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="modal-scroll-area">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Item Name</th>
                                        <th>HSN/SAC</th>
                                        <th>Rate</th>
                                        <th>GST %</th>
                                        <th style="width: 150px;">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="itemTableBody">
                                    <!-- Dynamic Rows -->
                                </tbody>
                            </table>
                        </div>
                        <div id="itemEmptyState" class="text-center py-4 text-muted">
                            No items found. Add items to list or type in invoice to auto-save.
                        </div>
                    </div>
                </div>
                <div class="modal-footer justify-content-start">
                    <button class="btn btn-primary" onclick="ItemManager.addRow()">
                        <i class="fas fa-plus me-1"></i>Add New Item
                    </button>
                    <!-- Hidden input to track if we are picking for a specific row -->
                    <input type="hidden" id="targetRowId" value="">
                    <button type="button" class="btn btn-secondary ms-auto" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Invoice History Modal -->
    <div class="modal fade" id="historyModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Invoice History</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="modal-scroll-area">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>Date Saved</th>
                                        <th>Invoice #</th>
                                        <th>Client</th>
                                        <th>Amount</th>
                                        <th style="width: 150px;">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="historyTableBody"></tbody>
                            </table>
                        </div>
                        <div id="historyEmptyState" class="text-center py-4 text-muted">
                            No saved invoices found.
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Error Logs Modal -->
    <div class="modal fade" id="viewLogsModal" tabindex="-1">
        <div class="modal-dialog modal-xl modal-dialog-scrollable">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title text-danger"><i class="fas fa-exclamation-triangle me-2"></i>Application
                        Error Logs</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body p-0">
                    <div class="modal-scroll-area">
                        <div id="logsContent" class="p-3 rounded border bg-dark text-light font-monospace small"
                            style="min-height: 200px; white-space: pre-wrap;">
                            No logs found.
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-outline-primary" onclick="ErrorLogger.download()">
                        <i class="fas fa-file-download me-1"></i>Download as .txt
                    </button>
                    <button type="button" class="btn btn-outline-danger" onclick="ErrorLogger.clear()">
                        <i class="fas fa-trash me-1"></i>Clear Logs
                    </button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hidden File Input for Import -->
    <input type="file" id="importFileInput" accept=".json" style="display: none;">

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js" defer></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2" defer></script>
    <script src="js/pdf-builder.js" defer></script>
    <script src="js/app.js?v=1" defer></script>

    <script>
        // Register Service Worker for PWA (Only if on HTTPS or Localhost)
        if ('serviceWorker' in navigator && (window.location.protocol === 'https:' || window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1')) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW Registered'))
                    .catch(err => console.log('SW Registration Failed', err));
            });
        } else {
            console.log('SW Registration skipped: Not on a secure origin or running locally via file://');
        }
    </script>
</body>

</html>
